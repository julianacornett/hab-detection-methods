---
title: "study_area_map"
author: "Juliana Cornett"
date: "2023-08-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#code to generate sst anomaly map and the study area map (Figures 1 & 2 in manuscript)

#install packages (rnaturalearth & rnaturalearth data for mapping data, ggplot2, ggpubr, viridis, & cowplot for creating figure, ggspatial for scale bar and N arrow)

```{r}
#install.packages("rnaturalearth")
#install.packages("rnaturalearthdata")
#install.packages("ggplot2")
#install.packages("ggpubr")
#install.packages("cowplot")
#install.packages("ggspatial")
#install.packages("viridis")
```

#load libraries 

```{r}
library(rnaturalearth)
library(rnaturalearthdata)
library(ggplot2)
library(ggpubr)
library(cowplot)
library(ggspatial)
library(viridis)
```

#high-resolution coastline data (downloaded from https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html - store file locally on Desktop and navigate to file with relative path because file is too large to push to GitHub)

```{r}
map_gshhs <- sf::read_sf('../../EMA/gshhg-shp-2.3.7/GSHHS_shp/f/GSHHS_f_L1.shp') 
```

#get natural earth land data

```{r}
world <- ne_countries(scale = "large", returnclass = "sf")
```

#put Juneau and Bridget Cove locations into dataframe

```{r}
sites <- data.frame(Location = c("Juneau, AK", "Bridget Cove"), longitude = c(-134.4201, -134.9488), latitude = c(58.3005, 58.6338))
```

#SEAK area base map - ADD INSET

```{r}
seak_area <- ggplot() +
  geom_sf(data = map_gshhs) + 
  coord_sf(xlim = c(-138, -130), ylim = c(54.6,59.6)) + 
  theme_pubr() +
  xlab("Longitude") +
  ylab("Latitude") +
  scale_x_continuous(breaks = c(-138, -136, -134, -132, -130)) +
  annotation_scale(location = "bl", width_hint = 0.4) +
  annotation_north_arrow(location = "bl", which_north = "true", 
        pad_x = unit(0.0, "in"), pad_y = unit(0.2, "in"),
        style = north_arrow_fancy_orienteering) + 
  geom_point(data = sites, aes(x = longitude, y = latitude, fill = Location), size = 5, 
        shape = 21) +
  scale_fill_manual(values = c("black", "white")) +
  theme(legend.position = "right") + 
  geom_rect(aes(xmin = -135.2, xmax = -134.1, ymin = 58.1, ymax = 58.8), fill = "transparent", color = "black") 
seak_area
```

#Bridget Cove inset map 

```{r}
bc_inset <- ggplot() +
  geom_sf(data = map_gshhs) + 
  coord_sf(xlim = c(-135.2, -134.1), ylim = c(58.1, 58.8)) + 
  geom_point(data = sites, aes(x = longitude, y = latitude, fill = Location), size = 5, 
        shape = 21) +
  scale_fill_manual(values = c("black", "white")) +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) +
   theme(panel.background = element_rect(fill = "white"),
        panel.ontop = FALSE)
bc_inset
```

#SEAK map with inset

```{r}
fig1 <- ggdraw(seak_area) +
  draw_plot(
    {bc_inset
      },
    # The distance along a (0,1) x-axis to draw the left edge of the plot
    x = 0.422, 
    # The distance along a (0,1) y-axis to draw the bottom edge of the plot
    y = 0.634,
    # The width and height of the plot expressed as proportion of the entire ggdraw object
    width = 0.35, 
    height = 0.35) 
fig1
```

#save as jpeg

```{r}
jpeg("../Figures/Fig1.jpg", width = 8, height = 5, units="in", res=600)
fig1
```

#AK map with SEAK inset for web story:

#Bridget Cove site only

```{r}
bc <- data.frame(Location = c("Sampling Location"), longitude = c(-134.9488), latitude = c(58.6338))
```

#Juneau only

```{r}
jnu <- data.frame(Location = c("Juneau, AK"), longitude = c(-134.4201), latitude = c(58.3005))
```

#AK map

```{r}
ak_map <- ggplot(data = world) +
  geom_sf() +
  coord_sf(xlim = c(-179.8, -115),
           ylim = c(72, 50),
           expand = FALSE) +
  xlab("Longitude") +
  ylab("Latitude") +
  scale_x_continuous(breaks = c(-120, -140, -160, -180)) +
  scale_y_continuous(breaks = c(50, 60, 70)) + 
  annotation_scale(location = "bl", width_hint = 0.4) +
  annotation_north_arrow(location = "bl", which_north = "true", 
        pad_x = unit(0.0, "in"), pad_y = unit(0.2, "in"),
        style = north_arrow_fancy_orienteering) + 
  geom_point(data = bc, aes(x = longitude, y = latitude, fill = Location), size = 5, 
        shape = 21) +
  theme_pubr() +
  scale_fill_manual(values = c("black")) +
  theme(legend.position = "right", legend.title = element_blank()) + 
  geom_rect(aes(xmin = -138, xmax = -130, ymin = 54.6, ymax = 59.6), fill = "transparent", color = "black") +
   geom_label(data = jnu, aes(x = longitude, y = latitude, label = Location, hjust = -0.1, vjust = 0.1), size = 3) 
ak_map
```

#save as jpeg

```{r}
jpeg("../Figures/AKMap.jpg", width = 8, height = 5, units="in", res=1200)
ak_map
```

#SEAK for inset

```{r}
seak_v2 <- ggplot() +
  geom_sf(data = map_gshhs) + 
  coord_sf(xlim = c(-138, -130), ylim = c(54.6,59.6)) + 
  theme_pubr() +
  geom_point(data = bc, aes(x = longitude, y = latitude, fill = Location), size = 3, 
        shape = 21) +
  scale_fill_manual(values = c("black")) +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) +
   theme(panel.background = element_rect(fill = "white"),
        panel.ontop = FALSE)
seak_v2
```

#save as jpeg

```{r}
jpeg("../Figures/JNUMap.jpg", width = 1.5, height = 2, units="in", res=1200)
seak_v2
```

#map with inset

```{r}
web_map <- ggdraw(ak_map) +
  draw_plot(
    {seak_v2
      },
    # The distance along a (0,1) x-axis to draw the left edge of the plot
    x = 0.46, 
    # The distance along a (0,1) y-axis to draw the bottom edge of the plot
    y = 0.521,
    # The width and height of the plot expressed as proportion of the entire ggdraw object
    width = 0.4, 
    height = 0.4) 
web_map
```

#save as jpeg

```{r}
jpeg("../Figures/WebStoryMap.jpg", width = 8, height = 5, units="in", res=600)
web_map
```

#updates: add Juneau as label on larger map; zoom in more on inset