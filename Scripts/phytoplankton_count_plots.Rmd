---
title: "phytoplankton_count_plots"
author: "Juliana Cornett"
date: "2023-08-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#code to generate phytoplankton count plots (Figure 2A, 2B, & 2C in manuscript)

#install packages (ggplot2 & ggpubr for creating figures, patchwork to combine figures; reshape2 for gathering into long format)

```{r}
#install.packages("ggplot2")
#install.packages("ggpubr")
#install.packages("patchwork")
#install.packages("reshape2")
```

#load libraries

```{r}
library(ggplot2)
library(ggpubr)
library(patchwork)
library(reshape2)
```

#read in Alexandrium count data (includes net tow, 1m, & 5m)

```{r}
alex <- read.csv("../Data/Alexandrium_MicroscopeCounts.csv")
```

#put date in date format for timeseries

```{r}
alex$Date <- as.Date(alex$Date, "%m/%d/%Y")
```

#palettes

```{r}
sunset_5 <- hcl.colors(5, palette = "Sunset")
```

```{r}
"#704D9E" "#BC5AA9" "#ED7C97" "#F9B282" "#F3E79A"
```

#net tow plot (A)

```{r}
plot_net <- ggplot(alex, aes(x = Date, y = Count_Net)) +
  geom_point(size = 5, shape = 21, fill = "#F9B282") +
  theme_pubr() +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
  labs(x = NULL, y = "Alexandrium in Net Tow (count)") +
annotate("text", x=as.Date("2023-05-04"), y=30, label = "A", size = 5) 
plot_net
```

#1m plot (B)

```{r}
plot_1m <- ggplot(alex, aes(x = Date, y = Count_1m_L)) +
  geom_point(size = 5, shape = 21, fill = "#ED7C97") +
  theme_pubr() +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
  labs(x = NULL, y = "Alexandrium at 1m (cells/L)") +
annotate("text", x=as.Date("2023-05-04"), y=1500, label = "B", size = 5) 
plot_1m
```

#5m plot (C)

```{r}
plot_5m <- ggplot(alex, aes(x = Date, y = Count_5m_L)) +
  geom_point(size = 5, shape = 21, fill = "#BC5AA9") +
  theme_pubr() +
  scale_x_date(date_breaks = "1 month", date_labels = "%b %Y") +
  labs(x = NULL, y = "Alexandrium at 5m (cells/L)") +
annotate("text", x=as.Date("2023-05-04"), y=1500, label = "C", size = 5) 
plot_5m
```

#save as jpeg (combined plot)

```{r}
jpeg("../Figures/Fig2.jpg", width = 8, height = 10, units="in", res=600)
plot_net / plot_1m / plot_5m 
```

#Pearson's correlation between collection methods

#calculate Pearson's correlation between 1m and 5m counts

```{r}
correlation_1m_5m <- cor.test(alex$Count_1m_L, alex$Count_5m_L, method = "pearson")
correlation_1m_5m
```

#visualize relationship between 1m and 5m counts

```{r}
plot_1m_5m <- ggplot(alex, aes(Count_1m_L, Count_5m_L)) + geom_point() + geom_smooth(method = "lm") + theme_pubr()
plot_1m_5m
```

#calculate Pearson's correlation between 1m and net tow

```{r}
correlation_1m_net <- cor.test(alex$Count_1m_L, alex$Count_Net, method = "pearson")
correlation_1m_net
```

#visualize relationship between 1m and net tow

```{r}
plot_1m_net <- ggplot(alex, aes(Count_1m_L, Count_Net)) + geom_point() + geom_smooth(method = "lm") + theme_pubr()
plot_1m_net
```

#calculate Pearson's correlation between 5m and net tow

```{r}
correlation_5m_net <- cor.test(alex$Count_5m_L, alex$Count_Net, method = "pearson")
correlation_5m_net
```

#visualize relationship between 5m and net tow

```{r}
plot_5m_net <- ggplot(alex, aes(Count_5m_L, Count_Net)) + geom_point() + geom_smooth(method = "lm") + theme_pubr()
plot_5m_net
```
