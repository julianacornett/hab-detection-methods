---
title: "timeseries_plots"
author: "Juliana Cornett"
date: "2024-03-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## timeseries plots

#install packages

```{r}
#install.packages("tidyverse")
#install.packages("ggpubr")
```

#load libraries

```{r}
library(tidyverse)
library(ggpubr)
```

#read in data

```{r}
psts <- read.csv("../Data/Oyster_PSTs.csv")
alex <- read.csv("../Data/Alexandrium_MicroscopeCounts.csv")
qpcr <- read.csv("../Data/Alexandrium_qPCR_Results.csv")
```

#format 

```{r}
psts$Date <- as.Date(psts$Date, "%m/%d/%Y")
alex$Date <- as.Date(alex$Date, "%m/%d/%Y")
qpcr$Date <- as.Date(qpcr$Date, "%m/%d/%Y")
qpcr <- subset(qpcr, qpcr$Sample_Type == "Sample")
qpcr <- subset(qpcr, qpcr$Quantity_Corrected >= 63.98)
```

#psts timeseries

```{r}
pst_time <- ggplot(psts, aes(x = Date, y = Tox_ug_100g, fill = Method, shape = Method)) + 
  scale_fill_manual(values = c("black", "darkgray"), labels = c("MBA", "ELISA")) +
  scale_shape_manual(values = c(24, 21), labels = c("MBA", "ELISA")) +
  geom_point(size = 4, color = "black", alpha = 0.75) +
  theme_pubr() +
  theme(legend.position = "right") +
  labs(
    x = element_blank(),
    y = "PSTs (\u00b5g/100g)")  +
  geom_hline(yintercept = 80, linetype = "dashed") +
  geom_hline(yintercept = 34, linetype = "dotted")
pst_time
```

#save as jpeg

```{r}
jpeg("../Figures/Fig7.jpg", width = 8, height = 5, units="in", res=600)
pst_time
```

#counts timeseries

#microscope timeseries (A) - one axis for cells (net) and one for cells/L (1m and 5m)

```{r}
alex
```

#qpcr timeseries (B)

```{r}
qpcr_mean <- aggregate(Copies_L_Corrected ~ Date, data = qpcr, FUN = mean)
qpcr_time <- ggplot(qpcr_mean, aes(x = Date, y = Copies_L_Corrected)) + 
  geom_point(size = 4, shape = 1) + 
  theme_pubr() + 
  scale_y_continuous(trans="log10") +
  labs(x = element_blank(), y = "Mean *A. catenella* qPCR Quantity (Copy Number/L; Log-transformed)") +
  theme(axis.title.y = ggtext::element_markdown()) +
  annotate("text", x=as.Date("2023-10-01"), y=1e+09, label = "A", size = 5)
 qpcr_time
```

#combined jpeg

```{r}

```

